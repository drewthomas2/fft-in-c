/*
 * main.c
 *
 *  Created on: May 30, 2023
 *      Author: drewthomas
 */

#include "main.h"
#include "fft.h"

int main(void){
	float d = 1; //just write 1 in order to have the same results of matlab fft(.)
	int n = 512; // array dimension
	float complex vec[512] = {0,0.125333233564304,0.248689887164855,0.368124552684678,0.481753674101715,0.587785252292473,0.684547105928689,0.770513242775789,0.844327925502015,0.90482705246602,0.951056516295154,0.982287250728689,0.998026728428272,0.998026728428272,0.982287250728689,0.951056516295154,0.904827052466019,0.844327925502015,0.770513242775789,0.684547105928689,0.587785252292473,0.481753674101716,0.368124552684678,0.248689887164855,0.125333233564304,1.22464679914735e-16,-0.125333233564304,-0.248689887164855,-0.368124552684678,-0.481753674101715,-0.587785252292473,-0.684547105928689,-0.770513242775789,-0.844327925502015,-0.904827052466019,-0.951056516295154,-0.982287250728689,-0.998026728428272,-0.998026728428272,-0.982287250728689,-0.951056516295154,-0.90482705246602,-0.844327925502016,-0.77051324277579,-0.684547105928689,-0.587785252292473,-0.481753674101715,-0.368124552684679,-0.248689887164854,-0.125333233564305,-2.44929359829471e-16,0.125333233564304,0.248689887164854,0.368124552684678,0.481753674101715,0.587785252292473,0.684547105928689,0.770513242775789,0.844327925502015,0.904827052466019,0.951056516295153,0.982287250728689,0.998026728428272,0.998026728428272,0.982287250728689,0.951056516295154,0.90482705246602,0.844327925502015,0.77051324277579,0.68454710592869,0.587785252292473,0.481753674101716,0.368124552684678,0.248689887164855,0.125333233564306,3.67394039744206e-16,-0.125333233564303,-0.248689887164855,-0.368124552684677,-0.481753674101714,-0.587785252292473,-0.684547105928688,-0.770513242775789,-0.844327925502015,-0.904827052466019,-0.951056516295153,-0.982287250728688,-0.998026728428272,-0.998026728428272,-0.982287250728689,-0.951056516295154,-0.90482705246602,-0.844327925502015,-0.77051324277579,-0.68454710592869,-0.587785252292473,-0.481753674101715,-0.368124552684678,-0.248689887164856,-0.125333233564306,-4.89858719658941e-16,0.125333233564305,0.248689887164855,0.368124552684677,0.481753674101714,0.587785252292473,0.684547105928689,0.770513242775789,0.844327925502015,0.904827052466019,0.951056516295153,0.982287250728689,0.998026728428272,0.998026728428272,0.982287250728689,0.951056516295154,0.904827052466019,0.844327925502015,0.77051324277579,0.68454710592869,0.587785252292475,0.481753674101715,0.368124552684678,0.248689887164857,0.125333233564304,6.12323399573677e-16,-0.125333233564305,-0.248689887164855,-0.368124552684679,-0.481753674101715,-0.587785252292473,-0.684547105928688,-0.770513242775788,-0.844327925502016,-0.90482705246602,-0.951056516295153,-0.982287250728688,-0.998026728428271,-0.998026728428272,-0.982287250728689,-0.951056516295154,-0.90482705246602,-0.844327925502016,-0.770513242775789,-0.684547105928689,-0.587785252292474,-0.481753674101717,-0.36812455268468,-0.248689887164858,-0.125333233564304,-7.34788079488412e-16,0.125333233564303,0.248689887164853,0.368124552684679,0.481753674101715,0.587785252292472,0.684547105928688,0.770513242775788,0.844327925502014,0.904827052466019,0.951056516295153,0.982287250728688,0.998026728428271,0.998026728428272,0.982287250728689,0.951056516295154,0.90482705246602,0.844327925502016,0.770513242775791,0.684547105928689,0.587785252292474,0.481753674101717,0.36812455268468,0.248689887164854,0.125333233564304,8.57252759403147e-16,-0.125333233564303,-0.248689887164853,-0.368124552684675,-0.481753674101712,-0.587785252292472,-0.684547105928688,-0.770513242775788,-0.844327925502015,-0.904827052466019,-0.951056516295153,-0.982287250728688,-0.998026728428271,-0.998026728428272,-0.982287250728689,-0.951056516295154,-0.90482705246602,-0.844327925502014,-0.770513242775789,-0.684547105928689,-0.587785252292474,-0.481753674101717,-0.36812455268468,-0.248689887164858,-0.125333233564308,-9.79717439317883e-16,0.125333233564303,0.248689887164856,0.368124552684678,0.481753674101715,0.587785252292472,0.684547105928687,0.770513242775788,0.844327925502013,0.904827052466018,0.951056516295153,0.982287250728688,0.998026728428272,0.998026728428272,0.982287250728689,0.951056516295154,0.90482705246602,0.844327925502016,0.770513242775791,0.684547105928692,0.587785252292474,0.481753674101717,0.368124552684677,0.248689887164854,0.125333233564305,1.10218211923262e-15,-0.125333233564302,-0.248689887164852,-0.368124552684675,-0.481753674101712,-0.587785252292469,-0.684547105928687,-0.77051324277579,-0.844327925502015,-0.904827052466019,-0.951056516295153,-0.982287250728688,-0.998026728428271,-0.998026728428272,-0.982287250728689,-0.951056516295155,-0.90482705246602,-0.844327925502015,-0.770513242775789,-0.684547105928689,-0.587785252292474,-0.48175367410172,-0.36812455268468,-0.248689887164855,-0.125333233564308,-1.22464679914735e-15,0.125333233564302,0.248689887164856,0.368124552684675,0.481753674101715,0.587785252292469,0.68454710592869,0.770513242775785,0.844327925502015,0.904827052466016,0.951056516295153,0.982287250728687,0.998026728428271,0.998026728428272,0.982287250728689,0.951056516295155,0.904827052466022,0.844327925502015,0.770513242775794,0.684547105928694,0.58778525229248,0.481753674101717,0.368124552684681,0.248689887164858,0.125333233564315,4.89982515786259e-15,-0.125333233564299,-0.248689887164849,-0.368124552684671,-0.481753674101708,-0.587785252292472,-0.684547105928687,-0.770513242775787,-0.844327925502009,-0.904827052466018,-0.951056516295152,-0.982287250728688,-0.998026728428271,-0.998026728428272,-0.982287250728689,-0.951056516295154,-0.90482705246602,-0.84432792550202,-0.770513242775791,-0.684547105928692,-0.587785252292477,-0.481753674101727,-0.368124552684684,-0.248689887164855,-0.125333233564312,-1.46957615897682e-15,0.125333233564295,0.248689887164852,0.368124552684675,0.481753674101711,0.587785252292463,0.684547105928685,0.770513242775785,0.844327925502011,0.904827052466016,0.951056516295151,0.982287250728688,0.998026728428271,0.998026728428272,0.982287250728691,0.951056516295155,0.904827052466022,0.844327925502019,0.770513242775794,0.684547105928694,0.587785252292474,0.481753674101717,0.368124552684681,0.248689887164865,0.125333233564309,5.14475451769206e-15,-0.125333233564298,-0.248689887164848,-0.368124552684671,-0.481753674101714,-0.587785252292472,-0.684547105928687,-0.770513242775783,-0.844327925502013,-0.904827052466018,-0.951056516295152,-0.982287250728686,-0.998026728428271,-0.998026728428272,-0.982287250728689,-0.951056516295154,-0.904827052466024,-0.844327925502017,-0.770513242775792,-0.684547105928692,-0.587785252292483,-0.48175367410172,-0.368124552684684,-0.248689887164862,-0.125333233564305,-8.8199328764073e-15,0.125333233564302,0.248689887164852,0.368124552684674,0.481753674101705,0.587785252292469,0.684547105928684,0.770513242775785,0.844327925502011,0.904827052466016,0.951056516295153,0.982287250728688,0.998026728428271,0.998026728428272,0.982287250728689,0.951056516295155,0.904827052466022,0.844327925502023,0.770513242775794,0.68454710592869,0.587785252292475,0.481753674101717,0.368124552684688,0.248689887164859,0.125333233564309,5.38968387752153e-15,-0.125333233564291,-0.248689887164848,-0.368124552684671,-0.481753674101714,-0.587785252292472,-0.684547105928682,-0.770513242775787,-0.844327925502013,-0.904827052466018,-0.95105651629515,-0.982287250728687,-0.998026728428271,-0.998026728428272,-0.982287250728689,-0.951056516295156,-0.904827052466021,-0.844327925502017,-0.770513242775792,-0.684547105928697,-0.587785252292478,-0.481753674101721,-0.368124552684684,-0.248689887164862,-0.125333233564313,-1.95943487863577e-15,0.125333233564302,0.248689887164851,0.368124552684668,0.481753674101711,0.587785252292469,0.684547105928684,0.770513242775785,0.844327925502011,0.904827052466016,0.951056516295151,0.982287250728688,0.998026728428271,0.998026728428272,0.98228725072869,0.951056516295155,0.904827052466022,0.844327925502019,0.770513242775794,0.684547105928695,0.587785252292475,0.481753674101724,0.368124552684681,0.248689887164859,0.125333233564309,5.634613237351e-15,-0.125333233564298,-0.248689887164848,-0.368124552684671,-0.481753674101708,-0.587785252292466,-0.684547105928687,-0.770513242775787,-0.844327925502013,-0.904827052466014,-0.951056516295152,-0.982287250728687,-0.998026728428271,-0.998026728428272,-0.98228725072869,-0.951056516295154,-0.904827052466021,-0.844327925502017,-0.770513242775796,-0.684547105928692,-0.587785252292478,-0.481753674101721,-0.368124552684685,-0.248689887164862,-0.125333233564313,-9.30979159606624e-15,0.125333233564301,0.248689887164844,0.368124552684674,0.481753674101711,0.587785252292468,0.684547105928684,0.770513242775785,0.844327925502011,0.904827052466016,0.951056516295151,0.982287250728687,0.998026728428271,0.998026728428272,0.98228725072869,0.951056516295155,0.904827052466022,0.844327925502019,0.770513242775794,0.684547105928695,0.587785252292481,0.481753674101718,0.368124552684681,0.248689887164859,0.125333233564309,5.87954259718047e-15,-0.125333233564298,-0.248689887164848,-0.36812455268467,-0.481753674101708,-0.587785252292465,-0.684547105928686,-0.770513242775787,-0.844327925502013,-0.904827052466017,-0.951056516295152,-0.982287250728687,-0.998026728428271,-0.998026728428272,-0.98228725072869,-0.951056516295154,-0.904827052466024,-0.844327925502021,-0.770513242775792,-0.684547105928693,-0.587785252292472,-0.481753674101727,-0.368124552684685,-0.248689887164863,-0.125333233564306,-1.66601483134967e-14,0.125333233564294,0.248689887164851,0.368124552684674,0.481753674101717,0.587785252292462,0.684547105928684,0.770513242775784,0.844327925502015,0.904827052466013,0.951056516295151,0.982287250728688
	};

    FILE *fft_raw = fopen("fft.csv", "w");
    if (fft_raw == NULL){
        printf("Error opening file!\n");
        exit(1);
    }

	// FILE *power = fopen("fft_pwr.csv", "w");
    // if (power == NULL){
    //     printf("Error opening file!\n");
    //     exit(1);
    // }

	// FILE *phase = fopen("fft_phase.csv", "w");
    // if (phase == NULL){
    //     printf("Error opening file!\n");
    //     exit(1);
    // }

	// FILE *magnitude = fopen("fft_mag.csv", "w");
    // if (phase == NULL){
    //     printf("Error opening file!\n");
    //     exit(1);
    // }

	FFT(vec, n, d);

	for(int i=0; i<n; i++){
		//printf("%.2f %+.2fi,\n", crealf(vec[i]), cimagf(vec[i]));
        fprintf(fft_raw, "%.2f %+.2fi,", crealf(vec[i]), cimagf(vec[i]));
		// fprintf(power, "%.2f,", pow(cabsf(vec[i]),2)/n);
		// fprintf(phase, "%.2f,", atanf(cimagf(vec[i])/crealf(vec[i])));
		// fprintf(magnitude, "%.2f,", cabsf(vec[i]));
	}
    fclose(fft_raw);
	// fclose(power);
	// fclose(phase);
	// fclose(magnitude);
	exit(1);
}
